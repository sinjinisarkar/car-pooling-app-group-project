{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
    <h2><strong>Pickup Location</strong></h2>
    <h3>Driver's View</h3>
    <p class="text-muted">You're tracking the passenger's location.</p>

    <input type="hidden" id="ride-id" value="{{ ride_id }}">
    <input type="hidden" id="user-type" value="driver">
    <input type="hidden" id="ride-date" value="{{ ride_date }}">
    <input type="hidden" id="current-username" value="{{ current_user.username }}">
    <p id="status-message" class="alert alert-info">Tracking your location...</p>

    <!-- Leaflet Map -->
    <div id="map" style="height: 400px;"></div>

    <!-- Visual Reminder (initially hidden) -->
    <div id="reminder-message" class="alert alert-warning mt-3" style="display: none; cursor: pointer;">
        ðŸ‘€ Passenger is nearby. <u>Click here to start the journey</u>
    </div>

    <!-- Reminder bar for multiple passengers (commuting) -->
    <div id="multi-reminder" class="alert alert-warning mt-3" style="display: none; cursor: pointer;">
        ðŸ‘¥ Some passengers are nearby. <u>Click here to start their journeys</u>
    </div>

    <!-- Ride Details Card -->
    <div class="card mt-4 shadow-sm">
        <div class="card-body">
            <h4 class="card-title">Ride Details</h4>
            <p><strong>From:</strong> {{ ride.from_location }}</p>
            <p><strong>To:</strong> {{ ride.to_location }}</p>
            <p><strong>Date:</strong> {{ ride_date }}</p>
            <p><strong>Driver:</strong> {{ driver_name }}</p>

            {% if passenger_name %}
                <p><strong>Passenger:</strong> {{ passenger_name }}</p>
            {% elif passenger_names %}
                <p><strong>Passengers:</strong></p>
                <ul>
                    {% for name in passenger_names %}
                        <li>{{ name }}</li>
                    {% endfor %}
                </ul>
            {% else %}
                <p class="text-muted">No passengers assigned yet.</p>
            {% endif %}
        </div>
    </div>

    <!-- Modal -->
    <div id="startJourneyModal" class="modal modal-pickup" style="display:none;">
        <div class="modal-content">
            <span id="closeModalBtn" class="close" >&times;</span>
            <h4>Passenger is nearby</h4>
            <p>Would you like to start the journey now?</p>
            <button id="startJourneyBtn" class="btn btn-success">Start Journey</button>
        </div>
    </div>
</div>


{% endblock %}
