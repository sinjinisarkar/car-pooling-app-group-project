{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
    <h2><strong>Pickup Location</strong></h2>
    <h3>Passenger's View</h3>
    <p class="text-muted">You're tracking the driver's location.</p>

    <input type="hidden" id="ride-id" value="{{ ride_id }}">
    <input type="hidden" id="user-type" value="passenger">
    <input type="hidden" id="ride-date" value="{{ ride_date }}">
    <input type="hidden" id="current-username" value="{{ current_user.username }}">
    <input type="hidden" id="ride-status" value="{{ ride.status }}">

    <p id="status-message" class="alert alert-info">Tracking your location...</p>

    <!-- Leaflet Map -->
    <div id="map" style="height: 400px;"></div>

     <!-- Ride Details Card -->
     <div class="card mt-4 shadow-sm">
        <div class="card-body">
            <h4 class="card-title">Ride Details</h4>
            <p><strong>From:</strong> {{ ride.from_location }}</p>
            <p><strong>To:</strong> {{ ride.to_location }}</p>
            <p><strong>Date:</strong> {{ ride_date }}</p>
            <p><strong>Driver:</strong> {{ driver_name }}</p>   
            <p><strong>You are logged in as:</strong> {{ current_user.username }}</p>
        </div>
    </div>

    <!-- Adjust Pickup Modal -->
    <div id="adjustPickupModal" class="modal modal-pickup" style="display: none;">
        <div class="modal-content">
            <span id="closeAdjustModal" class="close">&times;</span>
            <h4>Driver is far away</h4>
            <p>Would you like to adjust your pickup location?</p>
            <button id="adjustPickupBtn" class="btn btn-warning">Adjust on Map</button>
        </div>
    </div>
</div>

<!-- Journey Finished Banner -->
<div id="journeyFinishedBanner" style="
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
    color: white;
    font-size: 2rem;
    text-align: center;
    padding-top: 20%;
    z-index: 9999;
">
    <p><strong id="journeyBannerText"></strong></p>
</div>

<!-- Rating Modal -->
<div id="ratingModal" class="modal modal-pickup" style="display: none;">
    <div class="modal-content">
      <span id="closeRatingModal" class="close">&times;</span>
      <h4 class="modal-title">Rate Your Driver</h4>
      <div id="starContainer" style="font-size: 2rem; margin: 15px 0;"></div>
      <button id="submitRatingBtn" class="btn btn-green mt-3">Submit</button>
    </div>
</div>

{% endblock %}